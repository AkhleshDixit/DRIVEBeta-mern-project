{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Akhlesh dixit/Desktop/reactjs/DRIVEBeta/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Akhlesh dixit/Desktop/reactjs/DRIVEBeta/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/Akhlesh dixit/Desktop/reactjs/DRIVEBeta/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import{Pagination}from'../Pagination/Pagination';import filelstcss from'./UserFilesList.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var UserFilesList=function UserFilesList(){var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),files=_useState2[0],setFiles=_useState2[1];var id=localStorage.getItem('id');var deleteFile=function deleteFile(e){fetch(\"/user/delete/\".concat(e.target.id),{method:\"DELETE\"}).then(function(resp){resp.json().then(function(result){setFiles(files.splice(e.target.name,1));setFiles(files);});}).catch(function(err){console.log(err);});};var downloadFile=function downloadFile(e){var userFilePath=files[e.target.name].userFilePath;userFilePath=userFilePath.split(\"/\");// userFilePath = userFilePath.split(\"\\\\\");\nvar fileName=files[e.target.name].fileName;fetch(\"/user/download/\".concat(userFilePath[3])).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=fileName;_context.next=3;return res.blob();case 3:_context.t1=_context.sent;return _context.abrupt(\"return\",{filename:_context.t0,blob:_context.t1});case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).then(function(resObj){// It is necessary to create a new blob object with mime-type explicitly set for all browsers except Chrome, but it works for Chrome too.\nvar newBlob=new Blob([resObj.blob]);// MS Edge and IE don't allow using a blob object directly as link href, instead it is necessary to use msSaveOrOpenBlob\nif(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(newBlob);}else{// For other browsers: create a link pointing to the ObjectURL containing the blob.\nvar objUrl=window.URL.createObjectURL(newBlob);var link=document.createElement('a');link.href=objUrl;link.download=resObj.filename;link.click();// For Firefox it is necessary to delay revoking the ObjectURL.\nsetTimeout(function(){window.URL.revokeObjectURL(objUrl);},250);}}).catch(function(error){console.log('DOWNLOAD ERROR',error);});};useEffect(function(){fetch(\"/user/userFilesList/\".concat(id)).then(function(resp){resp.json().then(function(result){setFiles(result);});}).catch(function(err){console.log(err);});},[id]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:filelstcss.container,children:/*#__PURE__*/_jsxs(\"div\",{className:filelstcss.seccontainer,children:[/*#__PURE__*/_jsx(Pagination,{data:files,downloadFile:downloadFile,deleteFile:deleteFile}),/*#__PURE__*/_jsx(\"div\",{className:filelstcss.bckbtn,children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){history.goBack();},children:\"Go Back\"})})]})})});};","map":{"version":3,"sources":["C:/Users/Akhlesh dixit/Desktop/reactjs/DRIVEBeta/frontend/src/Components/UserFilesList/UserFilesList.js"],"names":["React","useState","useEffect","useHistory","Pagination","filelstcss","UserFilesList","history","files","setFiles","id","localStorage","getItem","deleteFile","e","fetch","target","method","then","resp","json","result","splice","name","catch","err","console","log","downloadFile","userFilePath","split","fileName","res","blob","filename","resObj","newBlob","Blob","window","navigator","msSaveOrOpenBlob","objUrl","URL","createObjectURL","link","document","createElement","href","download","click","setTimeout","revokeObjectURL","error","container","seccontainer","bckbtn","goBack"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { Pagination } from '../Pagination/Pagination';\r\nimport filelstcss from './UserFilesList.module.css'\r\n\r\nexport const UserFilesList = () => {\r\n\r\n    let history = useHistory();\r\n    const [files, setFiles] = useState([]);\r\n    const id = localStorage.getItem('id');\r\n\r\n    const deleteFile = (e) => {\r\n        fetch(`/user/delete/${e.target.id}`, { method: \"DELETE\" }).then(resp => {\r\n            resp.json().then((result) => {\r\n                setFiles(files.splice(e.target.name, 1));\r\n                setFiles(files);\r\n            });\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        });\r\n    }\r\n\r\n    const downloadFile = (e) => {\r\n        let userFilePath = files[e.target.name].userFilePath;\r\n        userFilePath = userFilePath.split(\"/\");\r\n        // userFilePath = userFilePath.split(\"\\\\\");\r\n        const fileName = files[e.target.name].fileName;\r\n\r\n        fetch(`/user/download/${userFilePath[3]}`)\r\n            .then(async res => ({\r\n                filename: fileName,\r\n                blob: await res.blob()\r\n            }))\r\n            .then(resObj => {\r\n                // It is necessary to create a new blob object with mime-type explicitly set for all browsers except Chrome, but it works for Chrome too.\r\n                const newBlob = new Blob([resObj.blob]);\r\n\r\n                // MS Edge and IE don't allow using a blob object directly as link href, instead it is necessary to use msSaveOrOpenBlob\r\n                if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                    window.navigator.msSaveOrOpenBlob(newBlob);\r\n                } else {\r\n                    // For other browsers: create a link pointing to the ObjectURL containing the blob.\r\n                    const objUrl = window.URL.createObjectURL(newBlob);\r\n\r\n                    let link = document.createElement('a');\r\n                    link.href = objUrl;\r\n                    link.download = resObj.filename;\r\n                    link.click();\r\n\r\n                    // For Firefox it is necessary to delay revoking the ObjectURL.\r\n                    setTimeout(() => { window.URL.revokeObjectURL(objUrl); }, 250);\r\n                }\r\n            })\r\n            .catch((error) => {\r\n                console.log('DOWNLOAD ERROR', error);\r\n            });\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetch(`/user/userFilesList/${id}`).then(resp => {\r\n            resp.json().then((result) => {\r\n                setFiles(result);\r\n            });\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        })\r\n    }, [id])\r\n\r\n\r\n    return (\r\n        <>\r\n            <div className={filelstcss.container}>\r\n                <div className={filelstcss.seccontainer}>\r\n                    <Pagination data={files} downloadFile={downloadFile} deleteFile={deleteFile} />\r\n                    <div className={filelstcss.bckbtn}>\r\n                        <button onClick={() => { history.goBack() }}>Go Back</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}